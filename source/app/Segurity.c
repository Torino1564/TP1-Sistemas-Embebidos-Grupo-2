/*****************************************************************************
  @file     Segurity.h
  @brief    Encargado de la seguridad del dispositivo
  @author   jpla
 ******************************************************************************/

/*******************************************************************************
*                                ENCABEZADOS
******************************************************************************/
#include "Segurity.h"

/*******************************************************************************
*                               ENUMERACIONES
******************************************************************************/
enum permissions{
	ADMIN,
	USER,
	SERVICE
};

/*******************************************************************************
*                                 VARIABLES
******************************************************************************/
static user_t users[10] = {
    { "12345678", "12345", USER },
    // otros usuarios...
}; // 10 hay que cambiarlo por el numero de users


/*******************************************************************************
*                                FUNCIONES
******************************************************************************/

bool IDSentinel(char * pID)
{
	int counter = 0;
	for(int i = 0 ; i <= 10 ; i++) // 10 hay que cambiarlo por el numero de users
	{
		for(int j = 0 ; j <= ID_MAX_LENGTH - 1 ; j++)
		{
			if(users[i].ID[j] == pID[j])
			{
				counter++;
				if(counter == ID_MAX_LENGTH)
				{
					return 1;
				}
			}
		}
		counter = 0;
	}
	return 0;
}
